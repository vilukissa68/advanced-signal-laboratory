% !TEX encoding = UTF-8 Unicode
\documentclass[12pt,a4paper,english
% ,twoside,openright
]{tunithesis}

\special{papersize=210mm,297mm}

\author{Roosa Kuusivaara \& Väinö-Waltteri Granat}
\title{Characterizing holographic displays via
numerical simulations - Report} % primary title (for front page)
\thesistype{Laboratory Report} % or Bachelor of Science, Laboratory Report...

\usepackage{lastpage}
\usepackage[english]{babel}
\usepackage[
backend=biber,
style=authoryear,
citestyle=authoryear,
autocite=inline
]{biblatex}
\usepackage{csquotes}
\usepackage{mathrsfs, amsmath}

\addbibresource{references.bib} %Imports bibliography file


\definecolor{tunipurple}{RGB}{78, 0, 142}

\newcommand\todo[1]{{\color{red}!!!TODO: #1}} % Remark text in braces appears in red
\newcommand{\angs}{\textsl{\AA}}              % , e.g. slanted symbol for Ångstöm
% Preparatory content ends here


\pagenumbering{roman} % was: {Roman}
\pagestyle{headings}
\begin{document}

% Special trick so that internal macros (denoted with @ in their name)
% can be used outside the cls file (e.g. \@author)
\makeatletter

% Create the title page.
% First the logo. Check its language.
\thispagestyle{empty}
\vspace*{-.5cm}\noindent

\begin{figure}
    \vspace{-1.3cm}
    \advance\leftskip-2.5cm
    \noindent\includegraphics{img/tunilogo.png}
\end{figure}
 
\vspace{2.5cm}
\begin{flushright}
\noindent\textsf{\LARGE{\@author}}

\noindent\vspace{0.5cm}

\noindent\Huge{\textsf{\textbf{\textcolor{tunipurple}{\@title}}}}
\end{flushright}
\vspace{13.7cm} % adjust to 12.7 this if thesis title needs two lines

% Last some additional info to the bottom-right corner
\begin{flushright}  
    \begin{spacing}{1.0}
      \textsf{Faculty of Information Technology and Communication Sciences (ITC)\\
      \@thesistype\\
      September 2023}
    \end{spacing}
\end{flushright}

% Leave the backside of title page empty in twoside mode
\if@twoside
\clearpage
\fi

% Turn off page numbering for the first pages
\pagenumbering{gobble}


% Some fields in abstract are automated, namely those with \@ (author,
% title, thesis type).
\chapter*{Abstract}
\begin{spacing}{1.0}
\noindent \@author: \@title\\
\@thesistype\\
Tampere University\\
Master’s Degree Programme in Signal Processing\\
September 2023
\end{spacing}
\noindent\rule{12cm}{0.4pt}

\vspace{0.5cm}

% ---------------------------------------
% Abstract and keywords
% ---------------------------------------

\noindent The abstract is a concise 1-page description of the work: what was the
problem, what was done, and what are the results. Do not include
charts or tables in the abstract.

These instructions are intended for students of Computer Sciences at the Tampere University. They cover questions of writing a thesis, such as use of the literature, structure of the thesis and style, the external appearance of the thesis and the use of tools.  These instructions do not cover the scientific content of the thesis.

~

\noindent\textbf{Keywords:} M.Sc. thesis, layout, writing style.

~


% Add the table of contents


\setcounter{tocdepth}{3}              % How many header level are included
\tableofcontents                      % Create TOC


% The actual text begins here and page numbering changes to 1,2...
% Leave the backside of title empty in twoside mode
\if@twoside
%\newpage
\cleardoublepage
\fi


\renewcommand{\chaptername}{} % This disables the prefix 'Chapter' or
                              % 'Luku' in page headers (in 'twoside'
                              % mode)


\chapter{Introduction}
\label{ch:intro}
\pagenumbering{arabic}
\setcounter{page}{1} 
In this report we describe our work with the `Characterizing holographic displays via
numerical simulations` exercise, for the Advanced Signal Processing Laboratory Course.

In this project we familiarized ourselves with the basics of holographic display, by implementing a part of a holographics display viewing simulation. We implemented two holographic synthesis methods and a retinal image formation model, by contributing code to a MATLAB codebase given by the course faculty.

\section{Hologram synthesis}
Hologram synthesis describes the method for forming holographic images in 3d space from a given image. In this assignment, instead of using entire 3d space, the analysis can be simplified by considering only a cross section of the 3d space. The hologram is now represented as a 1D array of complex values. This simplification eases the computational load and also makes the process easier to handle.

\section{Retinal Image Formation}
In the study of holographic displays and their numerical characterization, Retinal Image Formation is a key part of the analysis. This simulation mimics how the human eye perceives visual information. Through this model, we obtain images on the retina, which can be used to analyze the perceived sharpness of the displayed content.

In these simulation tools, the human eye is considered as a camera, with the lens (the pupil) and the retina (the sensor). This simulation involves three key planes: the display (hologram), the lens, and the sensor. We model the pupil as a thin lens with a specific width, influencing how light passes through it.



\chapter{Methodology}
\label{sec:methodology}

\section{Implementing Hologram Synthesis}
Our implementation of the holographic image viewer included three different methods of holographic image synthesis, one of which was provided in the code base given to us. The ready made synthesis method was holographic stereograph synthesis (HSS), [TODO: explain hss here]. The formula for holographic stereogram synthesis is 

\begin{align}
  \label{eq:hss}
  U(x;0) = \frac{a_p}{r_p}exp(i 2\pi(f_x(x-x_c))+\phi_p).
\end{align}
[is the formula of HSS necessary (and correct)? TODO: explain the function]


The first synthesis method we implemented was a Fresnel hologram synthesis which is based on the Fresnel diffraction kernel. Using this kernel to define the 1D field $U(x;0)$ for a single point source at  ($x_p$, $z_p$) as

\begin{align}
  \label{eq:fresnel}
  U(x;0) = a_p\frac{exp(j k z_p)}{\sqrt{j \lambda z_p}}exp(jk\frac{(x-x_p)^2}{2z_p}+\phi_p),
\end{align}
where $a_p$ is the amplitude of the point source, $\phi_p$ is the relative phase, $\lambda$ is the wavelength of the monochromatic light (i.e. the color, if in visible spectrum) and $k = \frac{2\pi}{\lambda}$ is the wave number.

The second method we implemented was Rayleigh-Sommerfeld synthesis (RSS), which uses Rayleigh-Sommerfeld diffraction kernel. 

\begin{align}
  \label{eq:rss}
  U(x;0) = a_p\frac{z_p}{\sqrt{j \lambda}[(x-x_p)^2+z_p^2)]^\frac{3}{4}}exp[jk\sqrt{(x-x_p)^2+z_p^2}+\phi_p]
\end{align}
This formula is similar to the Fresnel but has some differences in calculating the hologram. 

\section{Retinal Image Formation Simulation}
To be able to view the synthezised holograms, we had to simulate the viewing process of an eye. This was achieved with a simplified wave propagation model, where human eye is represented by a simple lens and a one-dimensional sensor behind the lens in relation to the viewed hologram.

The transmittance of the lens is described by function~\ref{eq:lens}

\begin{align}
  \label{eq:lens}
  T(s) = exp(\frac{-i\pi}{\lambda f}s^2),
\end{align}

where $f$ is the focal length of the lens.

The propagation of light from the hologram is modeled with a following field function~\ref{eq:field}

\begin{align}
  \label{eq:field}
  U(x;z) = \int \mathscr{F} \{U (\xi;z_0) \} (f_\xi) exp[-2 \pi i (f_\xi x + f_z z)] d f_\xi,
\end{align}

where

\begin{align}
  \label{eq:focus}
  f_z = \sqrt{\frac{1}{\lambda^2} - f_\xi ^ 2}
\end{align}

[TODO: Explain these functions]

The simplified eye model differs from a real human eye in multiple cases. Firstly, sensor of the human eye consists of two types of photosensitive cells, cones and rods, at the retina of the eyes. The simplified eye model does not usually take interaction and specialization of these two cell types into account, which is an important part of human vision function.

\subsection{Field propagation implementation}
The implementation of the field progation was provided to us in the code base, in the $propagateField\_PWD.m$ file. The file starts with defining the basic parameters, which are current location of the eye, distance from lens to sensor, the focal length of the eye and the physical size of the hologram plane.

In the next step the file sets up the more complex parts of the simulation, like size of the sensor, properties of the propagating light and the sampling grid.

Finally the file executes the field propagation simulation, where each of the sections of the synthezied hologram are propagated trough the wave field and the results are of the sensor are sampled to produces an image as PSF which is returned from the function.


\chapter{Results}
\label{sec:results}
In this section we analyze the images produced by the implemented model.

The wave propagation function produces a PSF images of the given hologram. These images were plotted as a function of the sensor positions. In the most optimal case all the values would be in a single pile at the zero coordinated of the sensor, i.e. the center of the sensor. This would mean that all the pixels were perceived at the best focus. The figures~\ref{fig:psf_single_fresnel} and~\ref{fig:psf_single_rs} so the plots for Fresnel synthesizied hologram and Rayleigh-Sommerfield synthesized hologram. The PSF plots of both of these methods were very similar, with tightly packed values close to 0. This indicated that these methods, with this given focal length, provides fairly sharp images. The holographic stereogram synthesized hologram produced as significantly less packed PSF plot, as shown in figure~\ref{fig:psf_single_hs}.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/psf_single_fresnel.eps}
  \caption{PSF results of the simulation with Fresnel synthesis}
  \label{fig:psf_single_fresnel}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/psf_single_rs.eps}
  \caption{PSF results of the simulation with Rayleigh-Sommerfield synthesis}
  \label{fig:psf_single_rs}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/psf_single_hs.eps}
  \caption{PSF results of the simulation with Holgraphic Stereopgram synthesis}
  \label{fig:psf_single_hs}
\end{figure}



\section{PSF analysis}
From the simulation we attained an image consisting of multiple overlayed PSF images depicting the hologram formed on the simulated sensor. From the image~\ref{fig:psf_multiple_fresnel} we can see that from the samples the $z_f$ value of $-0.42$ produces the sharpest image, since most of the points fall in the origin. This is different from what would be expected, since in ideal situation the sharpest images should form with the same values as the distance to point source, which in our simulation is $-0.4$. When the value of $z_f$ moves away from $-0.42$ we expected the graph to widen, since image formed won't be as sharp and this is reflected in the figure, as the values closer to $-0.42$ produce higher graphs.

We also repeated this for Rayleigh-Sommerfield synthesis and Holographic stereogram synthesis, as shown in figures~\ref{fig:psf_multiple_rs} and~\ref{fig:psf_multiple_hs}. The result for the Rayleigh-Sommerfield synthesis we basically identical, as the sharpest image, was obtained with the value of $-0.42$ and further away values produced wider graphs.

As for the holographic stereogram, the results different, in the sense that the sharpest image was produced with a $z_f$ value of $-0.44$. Also all the $z_f$ values produced blurrier images as the graphs were wider. This would indicate that the holographic stereogram produces overall blurrier holograms.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/psf_multiple_fresnel.eps}
  \caption{PSF results of the simulation with Fresnel synthesis, with multiple $z_f$ values between $-0.5$ and $-0.3$}
  \label{fig:psf_multiple_fresnel}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/psf_multiple_rs.eps}
  \caption{PSF results of the simulation with Rayleigh-Sommerfield synthesis, with multiple $z_f$ values between $-0.5$ and $-0.3$}
  \label{fig:psf_multiple_rs}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/psf_multiple_hs.eps}
  \caption{PSF results of the simulation with holograpic stereograph synthesis, with multiple $z_f$ values between $-0.5$ and $-0.3$}
  \label{fig:psf_multiple_hs}
\end{figure}

\section{MTF Analysis}
With the multiple PSF images we performed MTF analysis to obtain the value of $z_f$ which would provide the sharpest image. By generating multiple PSF images with different $z_f$ values we were able to obtain multiple MTF values in particular spectral frequency. We chose spectral frequency of 15 as suggested in the instructions.

We fitted a 7th degree polynomial function to datapoints of MTF values as a function of $z_f$ values. We chose to use 7th degree polynomial function, since after some experimentation, it seemed to visually be the best match for our datapoints. From the fitted function we could more confidentally determine the depth at which value of $z_f$ the image would be the sharpest. For the Fresnel and Rayleigh-Sommerield synthezied holograms the values was $-0.4190$ and for the stereogram synthesis the value was $-0.446$, as can be seen from figures~\ref{fig:mtf_fresnel}, \ref{fig:mtf_rs} and~\ref{fig:mtf_hs}.

The results where closely in line with the observations we made from the overlayed PSF images. The value optimal $z_f$ value in our system is slightly offset from the expected optimal value of $-0.4$, which corresponds to the point source of the hologarm. This offset might be caused by bad approximations in the hologram synthesis or bad assumptions during the wave field propagation. Our fitting function might not be optimal for this case.

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/mtf_fresnel.eps}
  \caption{MTF analysis results for Fresnel synthesis}
  \label{fig:mtf_fresnel}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/mtf_rs.eps}
  \caption{MTF analysis results for Rayleigh-Sommerfield synthesis}
  \label{fig:mtf_rs}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=\columnwidth]{img/mtf_hs.eps}
  \caption{MTF analysis results for Holographic stereograph synthesis}
  \label{fig:mtf_hs}
\end{figure}


\chapter{Conclusions}
This report described the work done for `Characterizing holographic displays via
numerical simulations` laboratory assignment. During which we learned about basics of holographics synthesis and wave field propagation, by implementing a Frensel synthesis and Rayleigh-Sommerfield synthesis methods in MATLAB as a part of hologram viewing simulation, as well as examining an existing implementation of holographic stereogram synthesis method. We used PSF image based analysis to demonstrate the differences in image quality between these methods.

Based on the analysis results we could conclude that for this particular simulation the Fresnel synthesis provided, the sharpest images, closely followed by the Rayleigh-Sommerfield synthesis. The holographic stereogram provided the worst results. It should be noted that these results are only applicable for this particular simulation. For example in 3D space the results might be different.


\label{ch:conclusions}


%
% The bibliography, i.e the list of references
%
\newpage

\printbibliography[title=References]
\addcontentsline{toc}{chapter}{References}

\appendix
\pagestyle{headings}



%
% a) Not-so-handy way, but at least it works
%
\def\appA{APPENDIX A. Something extra} % Define the name and numbering manually
\chapter*{\appA}                       % Create chapter heading
\markboth{\appA}{\appA}                % Set page header
\addcontentsline{toc}{chapter}{\appA}  % Include this in TOC
% Note that \label does not work with unnumbered chapter

Appendices are purely optional.  All appendices must be referred to in
the body text


\end{document}

